<!-- blog/templates/blog/blog_index.html -->
{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags blog_tags wagtailmarkdown %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/blog.css' %}">
{% endblock %}

{% block content %}
<div class="container blog-index mt-xl">

    <header class="blog-header">
        <h1 class="blog-index-title">{{ page.title }}</h1>
        {% if page.meta_description %}
        <p class="blog-subtitle">{{ page.meta_description }}</p>
        {% endif %}
    </header>

    {% if posts %}
    <div class="blog-list">
        {% for post in posts %}
        <article class="blog-list-item">
            <div class="post-meta">
                <time class="post-date" datetime="{{ post.date|date:'Y-m-d' }}">
                    {{ post.date|date:"M d, Y" }}
                </time>
                <span class="post-divider">•</span>
                <span class="post-reading-time">{{ post.body|wordcount|reading_time }} min read</span>
            </div>
            
            <h2 class="post-title">
                <a href="{{ post.url }}">{{ post.title }}</a>
            </h2>
            
            <p class="post-excerpt">
                {{ post.body|markdown|striptags|truncatewords:35 }}
            </p>
            
            <a href="{{ post.url }}" class="post-link">
                Read article
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
        </article>
        {% endfor %}
    </div>
    {% else %}
        <div class="empty-state">
            <p>No blog posts published yet. Check back soon!</p>
        </div>
    {% endif %}

    {% if posts.paginator.num_pages > 1 %}
    <nav class="pagination-wrapper">
        <ul class="pagination">
            {% if posts.has_previous %}
            <li><a href="?page={{ posts.previous_page_number }}">Prev</a></li>
            {% else %}
            <li class="disabled">← Prev</li>
            {% endif %}

            {% for num in posts.paginator.page_range %}
            <li class="{% if posts.number == num %}active{% endif %}">
                <a href="?page={{ num }}">{{ num }}</a>
            </li>
            {% endfor %}

            {% if posts.has_next %}
            <li><a href="?page={{ posts.next_page_number }}">Next</a></li>
            {% else %}
            <li class="disabled">Next →</li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}

</div>
{% endblock %}